<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5G边缘计算物联网平台 - 蚌埠学院</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f7fa; color: #333; }
        .container { display: flex; min-height: 100vh; }
        
        .sidebar { width: 250px; background: #2c3e50; color: white; padding: 20px 0; }
        .logo { padding: 0 20px 20px; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; }
        .nav-links { list-style: none; }
        .nav-links li { margin-bottom: 5px; }
        .nav-item { display: block; padding: 12px 20px; color: rgba(255,255,255,0.8); text-decoration: none; }
        .nav-item.active { background: rgba(255,255,255,0.1); color: white; }
        
        .main-content { flex: 1; display: flex; flex-direction: column; }
        .header { background: white; padding: 15px 30px; border-bottom: 1px solid #eee; }
        .content { flex: 1; padding: 20px; }
        .page { display: none; }
        .page.active { display: block; }
        
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); cursor: pointer; }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        
        .charts { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .chart { background: white; border-radius: 8px; padding: 15px; height: 300px; }
        
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; }
        
        .btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; margin: 2px; }
        .btn-primary { background: #3498db; color: white; }
        .btn-warning { background: #f39c12; color: white; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; padding: 20px; border-radius: 8px; width: 90%; max-width: 500px; }
        
        .device-selector { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .device-selector .btn { background: #ecf0f1; color: #2c3e50; }
        .device-selector .btn.active { background: #3498db; color: white; }
        
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="logo">
                <h1>5G边缘计算平台</h1>
                <p>蚌埠学院 · 物联网工程</p>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="nav-item active" data-page="dashboard">系统概览</a></li>
                <li><a href="#" class="nav-item" data-page="devices">设备管理</a></li>
                <li><a href="#" class="nav-item" data-page="analytics">数据分析</a></li>
                <li><a href="#" class="nav-item" data-page="edge-nodes">边缘节点</a></li>
                <li><a href="#" class="nav-item" data-page="warnings">警告中心</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <header class="header">
                <h2 id="page-title">物联网平台监控中心</h2>
                <div class="user-info">
                    <span>孙木</span>
                    <div class="status-indicator" style="width:10px;height:10px;background:#2ecc71;border-radius:50%;"></div>
                </div>
            </header>

            <div class="content">
                <!-- 系统概览 -->
                <div id="dashboard" class="page active">
                    <div class="stats">
                        <div class="stat-card" data-target="devices">
                            <h3>在线设备</h3>
                            <div class="value">24台</div>
                            <div class="trend">+2 今日</div>
                        </div>
                        <div class="stat-card" data-target="edge-nodes">
                            <h3>边缘节点</h3>
                            <div class="value">3/3</div>
                            <div class="trend">全部正常</div>
                        </div>
                        <div class="stat-card" data-target="analytics">
                            <h3>平均温度</h3>
                            <div class="value">23.5°C</div>
                            <div class="trend">-1.2°C</div>
                        </div>
                        <div class="stat-card" data-target="warnings">
                            <h3>今日警告</h3>
                            <div class="value">2条</div>
                            <div class="trend">-1 今日</div>
                        </div>
                    </div>

                    <div class="charts">
                        <div id="chart1" class="chart"></div>
                        <div id="chart2" class="chart"></div>
                    </div>
                </div>

                <!-- 设备管理 -->
                <div id="devices" class="page">
                    <div class="page-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h3>设备管理</h3>
                        <button class="btn btn-primary" id="addDeviceBtn">添加设备</button>
                    </div>
                    
                    <div id="deviceDetail" style="background:white;padding:15px;border-radius:8px;margin-bottom:15px;display:none;">
                        <h4>设备详情</h4>
                        <div id="deviceDetailContent"></div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr><th>设备ID</th><th>设备名称</th><th>类型</th><th>状态</th><th>最后上报</th><th>操作</th></tr>
                        </thead>
                        <tbody id="devicesTable">
                            <!-- 通过JS动态生成 -->
                        </tbody>
                    </table>
                </div>

                <!-- 数据分析 -->
                <div id="analytics" class="page">
                    <div class="page-header">
                        <h3>数据分析</h3>
                        <div style="display:flex;gap:10px;align-items:center;">
                            <select id="dataType">
                                <option value="temperature">温度分析</option>
                                <option value="humidity">湿度分析</option>
                                <option value="light">光照分析</option>
                            </select>
                            <div class="device-selector" id="deviceSelector">
                                <!-- 通过JS动态生成 -->
                            </div>
                        </div>
                    </div>
                    <div class="chart" id="analyticsChart" style="height:400px;"></div>
                </div>

                <!-- 其他页面 -->
                <div id="edge-nodes" class="page"><h3>边缘节点管理</h3><p>功能开发中...</p></div>
                <div id="warnings" class="page"><h3>警告中心</h3><p>功能开发中...</p></div>
            </div>
        </main>
    </div>

    <!-- 添加设备模态框 -->
    <div class="modal" id="addDeviceModal">
        <div class="modal-content">
            <h3>添加新设备</h3>
            <form id="addDeviceForm">
                <div class="form-group">
                    <label>设备名称</label>
                    <input type="text" id="deviceName" required>
                </div>
                <div class="form-group">
                    <label>设备类型</label>
                    <select id="deviceType" required>
                        <option value="temperature">温度传感器</option>
                        <option value="humidity">湿度传感器</option>
                        <option value="light">光照传感器</option>
                    </select>
                </div>
                <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:20px;">
                    <button type="button" class="btn" onclick="closeModal('addDeviceModal')">取消</button>
                    <button type="submit" class="btn btn-primary">添加</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 设备配置模态框 -->
    <div class="modal" id="configDeviceModal">
        <div class="modal-content">
            <h3 id="configModalTitle">设备配置</h3>
            <form id="configDeviceForm">
                <div class="form-group">
                    <label>设备名称</label>
                    <input type="text" id="configDeviceName" required>
                </div>
                <div class="form-group">
                    <label>采样频率</label>
                    <select id="configSamplingRate" required>
                        <option value="1">1秒/次</option>
                        <option value="5">5秒/次</option>
                        <option value="10">10秒/次</option>
                    </select>
                </div>
                <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:20px;">
                    <button type="button" class="btn" onclick="closeModal('configDeviceModal')">取消</button>
                    <button type="submit" class="btn btn-primary">保存</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // 设备数据
        const devices = [
            { id: 'DEV001', name: '温度传感器-01', type: '温度传感器', status: '在线', lastReport: '刚刚', location: '实验室A区', battery: '85%' },
            { id: 'DEV002', name: '湿度传感器-01', type: '湿度传感器', status: '在线', lastReport: '2分钟前', location: '实验室B区', battery: '92%' },
            { id: 'DEV003', name: '光照传感器-01', type: '光照传感器', status: '在线', lastReport: '5分钟前', location: '室外平台', battery: '45%' }
        ];

        // 设备历史数据
        const deviceHistory = {
            'DEV001': { temperature: [22,23,25,26,24,23,22], humidity: [65,64,63,62,63,64,65], light: [300,350,400,500,600,550,450] },
            'DEV002': { temperature: [21,22,23,24,25,24,23], humidity: [70,68,65,60,62,65,68], light: [200,250,300,400,500,450,350] },
            'DEV003': { temperature: [20,21,22,23,24,25,26], humidity: [75,73,70,68,65,63,60], light: [400,500,600,700,800,750,650] }
        };

        document.addEventListener('DOMContentLoaded', function() {
            initNavigation();
            initDeviceTable();
            initCharts();
            initDeviceSelector();
            
            // 添加设备按钮事件
            document.getElementById('addDeviceBtn').addEventListener('click', function() {
                document.getElementById('addDeviceModal').classList.add('active');
            });
            
            // 添加设备表单提交
            document.getElementById('addDeviceForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const newDevice = {
                    id: 'DEV' + (devices.length + 1).toString().padStart(3, '0'),
                    name: document.getElementById('deviceName').value,
                    type: document.getElementById('deviceType').selectedOptions[0].text,
                    status: '在线',
                    lastReport: '刚刚',
                    location: '新位置',
                    battery: '100%'
                };
                devices.push(newDevice);
                initDeviceTable();
                closeModal('addDeviceModal');
                this.reset();
                alert('设备添加成功！');
            });
            
            // 配置设备表单提交
            document.getElementById('configDeviceForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const deviceId = this.getAttribute('data-device-id');
                const device = devices.find(d => d.id === deviceId);
                if (device) {
                    device.name = document.getElementById('configDeviceName').value;
                    initDeviceTable();
                    closeModal('configDeviceModal');
                    alert('配置保存成功！');
                }
            });
        });

        function initNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const pages = document.querySelectorAll('.page');
            const pageTitle = document.getElementById('page-title');
            const statCards = document.querySelectorAll('.stat-card[data-target]');
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    const targetPage = this.getAttribute('data-page');
                    pages.forEach(page => {
                        page.classList.remove('active');
                        if (page.id === targetPage) page.classList.add('active');
                    });
                    
                    const titles = {
                        'dashboard': '物联网平台监控中心',
                        'devices': '设备管理', 
                        'analytics': '数据分析',
                        'edge-nodes': '边缘节点管理',
                        'warnings': '警告中心'
                    };
                    pageTitle.textContent = titles[targetPage];
                });
            });
            
            statCards.forEach(card => {
                card.addEventListener('click', function() {
                    const targetPage = this.getAttribute('data-target');
                    document.querySelector(`[data-page="${targetPage}"]`).click();
                });
            });
        }

        function initDeviceTable() {
            const tbody = document.getElementById('devicesTable');
            tbody.innerHTML = devices.map(device => `
                <tr>
                    <td>${device.id}</td>
                    <td>${device.name}</td>
                    <td>${device.type}</td>
                    <td><span style="padding:4px 8px;background:#e8f6ef;color:#27ae60;border-radius:4px;">${device.status}</span></td>
                    <td>${device.lastReport}</td>
                    <td>
                        <button class="btn btn-primary" onclick="showDeviceDetail('${device.id}')">详情</button>
                        <button class="btn btn-warning" onclick="showDeviceConfig('${device.id}')">配置</button>
                    </td>
                </tr>
            `).join('');
        }

        function showDeviceDetail(deviceId) {
            const device = devices.find(d => d.id === deviceId);
            const detailDiv = document.getElementById('deviceDetail');
            const contentDiv = document.getElementById('deviceDetailContent');
            
            if (device) {
                contentDiv.innerHTML = `
                    <p><strong>设备ID:</strong> ${device.id}</p>
                    <p><strong>设备名称:</strong> ${device.name}</p>
                    <p><strong>设备类型:</strong> ${device.type}</p>
                    <p><strong>安装位置:</strong> ${device.location}</p>
                    <p><strong>电池电量:</strong> ${device.battery}</p>
                    <p><strong>最后上报:</strong> ${device.lastReport}</p>
                `;
                detailDiv.style.display = 'block';
            }
        }

        function showDeviceConfig(deviceId) {
            const device = devices.find(d => d.id === deviceId);
            if (device) {
                document.getElementById('configModalTitle').textContent = `配置 ${device.name}`;
                document.getElementById('configDeviceName').value = device.name;
                document.getElementById('configDeviceForm').setAttribute('data-device-id', deviceId);
                document.getElementById('configDeviceModal').classList.add('active');
            }
        }

        function initDeviceSelector() {
            const selector = document.getElementById('deviceSelector');
            selector.innerHTML = `
                <button class="btn active" data-device="all">全部设备</button>
                ${devices.map(device => 
                    `<button class="btn" data-device="${device.id}">${device.name}</button>`
                ).join('')}
            `;
            
            selector.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    selector.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateAnalyticsChart(this.getAttribute('data-device'));
                });
            });
        }

        function updateAnalyticsChart(selectedDevice) {
            const dataType = document.getElementById('dataType').value;
            const chart = echarts.init(document.getElementById('analyticsChart'));
            
            let chartData, chartTitle;
            if (selectedDevice === 'all') {
                // 多设备数据对比
                chartData = devices.map(device => ({
                    name: device.name,
                    data: deviceHistory[device.id] ? deviceHistory[device.id][dataType] : []
                }));
                chartTitle = '多设备数据对比';
            } else {
                // 单设备数据趋势
                const device = devices.find(d => d.id === selectedDevice);
                chartData = [{
                    name: device.name,
                    data: deviceHistory[selectedDevice] ? deviceHistory[selectedDevice][dataType] : []
                }];
                chartTitle = `${device.name}数据趋势`;
            }
            
            chart.setOption({
                title: { text: chartTitle, left: 'center' },
                tooltip: { trigger: 'axis' },
                legend: { data: chartData.map(d => d.name), bottom: 0 },
                xAxis: { type: 'category', data: ['08:00','10:00','12:00','14:00','16:00','18:00','20:00'] },
                yAxis: { type: 'value' },
                series: chartData.map(device => ({
                    name: device.name,
                    type: 'line',
                    data: device.data,
                    smooth: true
                }))
            });
        }

        function initCharts() {
            // 系统概览图表1 - 多设备数据趋势
            const chart1 = echarts.init(document.getElementById('chart1'));
            chart1.setOption({
                title: { text: '多设备数据趋势', left: 'center' },
                tooltip: { trigger: 'axis' },
                legend: { data: ['温度传感器-01', '湿度传感器-01', '光照传感器-01'], bottom: 0 },
                xAxis: { type: 'category', data: ['08:00','10:00','12:00','14:00','16:00','18:00','20:00'] },
                yAxis: { type: 'value' },
                series: [
                    { name: '温度传感器-01', type: 'line', data: [22,23,25,26,24,23,22], smooth: true },
                    { name: '湿度传感器-01', type: 'line', data: [70,68,65,60,62,65,68], smooth: true },
                    { name: '光照传感器-01', type: 'line', data: [300,500,800,900,600,400,200], smooth: true }
                ]
            });
            
            // 系统概览图表2 - 数据流量监控（替换原来的节点负载）
            const chart2 = echarts.init(document.getElementById('chart2'));
            chart2.setOption({
                title: { text: '数据流量监控', left: 'center' },
                tooltip: { trigger: 'axis' },
                xAxis: { type: 'category', data: ['00:00','04:00','08:00','12:00','16:00','20:00','24:00'] },
                yAxis: { type: 'value', name: '数据量 (MB)' },
                series: [{
                    name: '数据流量',
                    type: 'bar',
                    data: [120,200,150,80,70,110,130]
                }]
            });
            
            // 初始化分析图表
            updateAnalyticsChart('all');
            
            // 监听数据类型变化
            document.getElementById('dataType').addEventListener('change', function() {
                const selectedDevice = document.querySelector('#deviceSelector .btn.active').getAttribute('data-device');
                updateAnalyticsChart(selectedDevice);
            });
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
    </script>
</body>
</html>
